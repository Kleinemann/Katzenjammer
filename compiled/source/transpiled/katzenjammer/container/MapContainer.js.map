{
  "version": 3,
  "sources": [
    "C:/Workspace/katzenjammer/source/class/katzenjammer/container/MapContainer.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "statics",
    "Instance",
    "properties",
    "Map",
    "init",
    "CurrentMarker",
    "nullable",
    "Marker",
    "UserBuildings",
    "UserQuests",
    "construct",
    "katzenjammer",
    "container",
    "MapContainer",
    "addListenerOnce",
    "initMap",
    "moveRandomPos",
    "members",
    "mapOptions",
    "center",
    "zoom",
    "map",
    "L",
    "getContentElement",
    "getDomElement",
    "layer",
    "TileLayer",
    "addLayer",
    "setTimeout",
    "invalidateSize",
    "setMap",
    "getMap",
    "setView",
    "LatLng",
    "Math",
    "random",
    "movePosition",
    "pos",
    "lat",
    "undefined",
    "lon",
    "createMarker",
    "source",
    "old",
    "getCurrentMarker",
    "remove",
    "marker",
    "draggable",
    "title",
    "setCurrentMarker",
    "on",
    "e",
    "latLng",
    "target",
    "_latlng",
    "lng",
    "updateMarker",
    "addTo",
    "updateMapMarker",
    "updateUserBuildings",
    "updateUserQuests",
    "oldUserQuests",
    "getMarker",
    "i",
    "userQuestMarkers",
    "userQuests",
    "data",
    "User",
    "getQuests",
    "quest",
    "createQuest",
    "getID",
    "oldBuildings",
    "buildingMarkers",
    "userBuildings",
    "getBuildings",
    "building",
    "createBuilding",
    "getIcon",
    "iconId",
    "iconData",
    "GameData",
    "Icons",
    "console",
    "log",
    "bIcon",
    "icon",
    "getPosition",
    "getName"
  ],
  "mappings": "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",
  "sourcesContent": [
    "ï»¿/* global katzenjammer */\r\n/**\r\n*\r\n * @asset(katzenjammer/*)\r\n*\r\n**/\r\nqx.Class.define(\"katzenjammer.container.MapContainer\", {\r\n    extend: qx.ui.core.Widget,\r\n\r\n    statics:\r\n    {\r\n        Instance: null\r\n    },\r\n\r\n    properties:\r\n    {\r\n        Map: { init: null },\r\n        CurrentMarker: { init: null, nullable: true },\r\n\r\n        Marker: {\r\n            init: {\r\n                UserBuildings: [],\r\n                UserQuests: [],\r\n            }\r\n        }\r\n    },\r\n\r\n    construct: function ()\r\n    {\r\n        this.base(arguments);\r\n        katzenjammer.container.MapContainer.Instance = this;\r\n\r\n        this.addListenerOnce(\"appear\", function ()\r\n        {\r\n            this.initMap();\r\n            this.moveRandomPos();\r\n        }, this);\r\n    },\r\n\r\n    members:\r\n    {\r\n        initMap: function ()\r\n        {\r\n            // Creating map options\r\n            var mapOptions = {\r\n                center: [17.385044, 78.486671],\r\n                zoom: 10\r\n            }\r\n            // Creating a map object\r\n            var map = new L.map(this.getContentElement().getDomElement(), mapOptions);\r\n\r\n            // Creating a Layer object\r\n            //var layer = new L.TileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');\r\n            var layer = new L.TileLayer('https://tile-{s}.openstreetmap.fr/hot/{z}/{x}/{y}.png');\r\n\r\n            // Adding layer to the map\r\n            map.addLayer(layer);\r\n            setTimeout(function () { map.invalidateSize() }, 0);\r\n\r\n            /*\r\n            var geocoder = L.Control.geocoder().on('markgeocode', function (e)\r\n            {\r\n                console.log(e);\r\n            }).addTo(map);\r\n            */\r\n            this.setMap(map);\r\n        },\r\n\r\n        moveRandomPos: function ()\r\n        {\r\n            var map = this.getMap();\r\n            if (map !== null)\r\n                map.setView(new L.LatLng(Math.random() * 90, Math.random() * 90), 5);\r\n        },\r\n\r\n        movePosition: function (pos, zoom)\r\n        {\r\n            var map = this.getMap();\r\n            if (map !== null) {\r\n                if (pos.lat !== undefined)\r\n                    map.setView(new L.LatLng(pos.lat, pos.lon), zoom !== undefined ? zoom : 10);\r\n                else\r\n                    map.setView(new L.LatLng(pos[0], pos[1]), zoom !== undefined ? zoom : 10);\r\n            }\r\n        },\r\n\r\n        createMarker: function (pos, source)\r\n        {\r\n            var map = this.getMap();\r\n            this.movePosition(pos);\r\n\r\n            var old = this.getCurrentMarker();\r\n            if (old !== null)\r\n                old.remove();\r\n\r\n            var marker = L.marker(pos, { draggable: true, title: \"Marker kann verschoben werden\" });\r\n\r\n            this.setCurrentMarker(marker);\r\n\r\n            if (source !== undefined)\r\n            {\r\n                marker.on(\"moveend\", function (e)\r\n                {\r\n                    var latLng = e.target._latlng;\r\n                    var pos = [latLng.lat, latLng.lng];\r\n\r\n                    source.updateMarker(pos);\r\n                }, this);\r\n            }\r\n\r\n            marker.addTo(map);\r\n        },\r\n\r\n\r\n        updateMapMarker: function ()\r\n        {\r\n            this.updateUserBuildings();\r\n            this.updateUserQuests();\r\n        },\r\n\r\n        updateUserQuests: function ()\r\n        {\r\n            var oldUserQuests = this.getMarker().UserQuests;\r\n            for (var i in oldUserQuests)\r\n                oldUserQuests[i].remove();\r\n\r\n            var map = this.getMap();\r\n\r\n            var userQuestMarkers = [];\r\n            var userQuests = katzenjammer.data.User.Instance.getQuests();\r\n            for (var i in userQuests) {\r\n                var quest = userQuests[i];\r\n                var marker = this.createQuest(quest);\r\n                userQuestMarkers[quest.getID()] = marker;\r\n                marker.addTo(map);\r\n            }\r\n\r\n            this.getMarker().UserQuests = userQuestMarkers;\r\n        },\r\n\r\n        updateUserBuildings: function ()\r\n        {\r\n            var oldBuildings = this.getMarker().UserBuildings;\r\n            for (var i in oldBuildings)\r\n                oldBuildings[i].remove();\r\n\r\n            var map = this.getMap();\r\n\r\n            var buildingMarkers = [];\r\n            var userBuildings = katzenjammer.data.User.Instance.getBuildings();\r\n            for (var i in userBuildings)\r\n            {\r\n                var building = userBuildings[i];\r\n                var marker = this.createBuilding(building);\r\n                buildingMarkers[building.getID()] = marker;\r\n                marker.addTo(map);\r\n            }\r\n\r\n            this.getMarker().UserBuildings = buildingMarkers;\r\n        },\r\n\r\n        getIcon: function (iconId)\r\n        {\r\n            var iconData = katzenjammer.data.GameData.Icons[iconId];\r\n            console.log(iconData);\r\n        },\r\n\r\n        createBuilding: function (building)\r\n        {\r\n            var bIcon = L.icon(building.getIcon() );\r\n            var marker = L.marker(building.getPosition(), { title: building.getName(), icon: bIcon });\r\n            return marker;\r\n        },\r\n\r\n        createQuest: function (quest)\r\n        {\r\n            var bIcon = L.icon(quest.getIcon());\r\n            var marker = L.marker(quest.getPosition(), { title: quest.getName(), icon: bIcon });\r\n            return marker;\r\n        }\r\n    }\r\n});\r\n"
  ]
}