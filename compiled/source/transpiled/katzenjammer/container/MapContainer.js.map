{
  "version": 3,
  "sources": [
    "C:/Workspace/katzenjammer/source/class/katzenjammer/container/MapContainer.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "statics",
    "Instance",
    "properties",
    "Map",
    "init",
    "CurrentMarker",
    "nullable",
    "Marker",
    "UserBuildings",
    "construct",
    "katzenjammer",
    "container",
    "MapContainer",
    "addListenerOnce",
    "initMap",
    "moveRandomPos",
    "members",
    "mapOptions",
    "center",
    "zoom",
    "map",
    "L",
    "getContentElement",
    "getDomElement",
    "layer",
    "TileLayer",
    "addLayer",
    "geocoder",
    "Control",
    "on",
    "e",
    "console",
    "log",
    "addTo",
    "setMap",
    "getMap",
    "setView",
    "LatLng",
    "Math",
    "random",
    "movePosition",
    "pos",
    "undefined",
    "createMarker",
    "source",
    "old",
    "getCurrentMarker",
    "remove",
    "marker",
    "draggable",
    "title",
    "setCurrentMarker",
    "latLng",
    "target",
    "_latlng",
    "lat",
    "lng",
    "updateMarker",
    "updateUserBuildings",
    "oldBuildings",
    "getMarker",
    "i",
    "buildingMarkers",
    "userBuildings",
    "data",
    "User",
    "getBuildings",
    "building",
    "createBuilding",
    "getID",
    "getPosition",
    "getName"
  ],
  "mappings": "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",
  "sourcesContent": [
    "ï»¿/* global katzenjammer */\r\n/**\r\n*\r\n * @asset(katzenjammer/*)\r\n*\r\n**/\r\nqx.Class.define(\"katzenjammer.container.MapContainer\", {\r\n    extend: qx.ui.core.Widget,\r\n\r\n    statics:\r\n    {\r\n        Instance: null\r\n    },\r\n\r\n    properties:\r\n    {\r\n        Map: { init: null },\r\n        CurrentMarker: { init: null, nullable: true },\r\n\r\n        Marker: {\r\n            init: {\r\n                UserBuildings: []\r\n            }\r\n        }\r\n    },\r\n\r\n    construct: function ()\r\n    {\r\n        this.base(arguments);\r\n        katzenjammer.container.MapContainer.Instance = this;\r\n\r\n        this.addListenerOnce(\"appear\", function ()\r\n        {\r\n            this.initMap();\r\n            this.moveRandomPos();\r\n        }, this);\r\n    },\r\n\r\n    members:\r\n    {\r\n        initMap: function ()\r\n        {\r\n            // Creating map options\r\n            var mapOptions = {\r\n                center: [17.385044, 78.486671],\r\n                zoom: 10\r\n            }\r\n\r\n            // Creating a map object\r\n            var map = new L.map(this.getContentElement().getDomElement(), mapOptions);\r\n\r\n            // Creating a Layer object\r\n            var layer = new L.TileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');\r\n\r\n            // Adding layer to the map\r\n            map.addLayer(layer);\r\n\r\n            \r\n            var geocoder = L.Control.geocoder().on('markgeocode', function (e)\r\n            {\r\n                console.log(e);\r\n            }).addTo(map);\r\n            \r\n            this.setMap(map);\r\n        },\r\n\r\n        moveRandomPos: function ()\r\n        {\r\n            var map = this.getMap();\r\n            if (map !== null)\r\n                map.setView(new L.LatLng(Math.random() * 90, Math.random() * 90), 5);\r\n        },\r\n\r\n        movePosition: function (pos, zoom)\r\n        {\r\n            var map = this.getMap();\r\n            if (map !== null)\r\n                map.setView(new L.LatLng(pos[0], pos[1]), zoom !== undefined ? zoom : 15);\r\n        },\r\n\r\n        createMarker: function (pos, source)\r\n        {\r\n            var map = this.getMap();\r\n            this.movePosition(pos);\r\n\r\n            var old = this.getCurrentMarker();\r\n            if (old !== null)\r\n                old.remove();\r\n\r\n            var marker = L.marker(pos, { draggable: true, title: \"Marker kann verschoben werden\" });\r\n\r\n            this.setCurrentMarker(marker);\r\n\r\n            if (source !== undefined)\r\n            {\r\n                marker.on(\"moveend\", function (e)\r\n                {\r\n                    var latLng = e.target._latlng;\r\n                    var pos = [latLng.lat, latLng.lng];\r\n\r\n                    source.updateMarker(pos);\r\n                }, this);\r\n            }\r\n\r\n            marker.addTo(map);\r\n        },\r\n\r\n        updateUserBuildings: function ()\r\n        {\r\n            var oldBuildings = this.getMarker().UserBuildings;\r\n            for (var i in oldBuildings)\r\n                oldBuildings[i].remove();\r\n\r\n            var map = this.getMap();\r\n\r\n            var buildingMarkers = [];\r\n            var userBuildings = katzenjammer.data.User.Instance.getBuildings();\r\n            for (var i in userBuildings)\r\n            {\r\n                var building = userBuildings[i];\r\n                var marker = this.createBuilding(building);\r\n                buildingMarkers[building.getID] = marker;\r\n                marker.addTo(map);\r\n            }\r\n\r\n            this.getMarker().UserBuildings = buildingMarkers;\r\n\t\t},\r\n\r\n        createBuilding: function (building)\r\n        {\r\n            var marker = L.marker(building.getPosition(), { title: building.getName() });\r\n            return marker;\r\n\t\t}\r\n    }\r\n});\r\n"
  ]
}